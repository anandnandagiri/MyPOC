# OpenCoverDemo - Functional Test Coverage

### OpenCover
OpenCover can be used for functional test coverage. 
Please visit [OpenCover GitHub](https://github.com/OpenCover/opencover) for more info

Based On .NET Framework direct download link mentioned below for Open Cover as ZIP (With Out Installing) \
.NET 4.5 Download Link [Click Here](https://github.com/OpenCover/opencover/releases/download/4.5.3427/opencover.4.5.3427.zip) \
.NET 4.7 Download Link [Click Here](https://github.com/OpenCover/opencover/releases/download/4.7.922/opencover.4.7.922.zip)

#### Note: 
Always recommanded to use latest OpenCover Download Link [Click Here](https://github.com/OpenCover/opencover/releases)

### Generating OpenCover Report
ReportGenerator converts coverage reports generated by OpenCover, dotCover, Visual Studio, NCover, Cobertura, JaCoCo, Clover, gcov or lcov into human readable reports in various formats
Please visit [ReportGenerator GitHub](https://github.com/danielpalme/ReportGenerator) for more info

Based On .NET Framework direct download link mentioned below for Open Cover as ZIP (With Out Installing) \
.NET 4.5 Download Link [Click Here](https://github.com/danielpalme/ReportGenerator/releases/download/v3.1.2.0/ReportGenerator_3.1.2.0.zip) \
.NET 4.7 Download Link [Click Here](https://github.com/danielpalme/ReportGenerator/releases/download/v4.2.5/ReportGenerator_4.2.5.zip)


#### Note: 
Always recommanded to use latest OpenCover Report Download Link [Click Here](https://github.com/danielpalme/ReportGenerator/releases)

### Sample OpenCover Demo Apps

ASPX Download Link [Visit Page](https://github.com/VAapps/OpenCoverDemo/tree/master/ASPXSample) \
MVC [Yet To Release] \
Console App [Yet To Release] 

#### Sample OpenCover Demo Apps Release Direct Links
[ASPX Sample](https://github.com/VAapps/OpenCoverDemo/raw/master/Release/aspx.zip)

### Sample Commands for OpenCover and ReportGenerator

#### Open Cover
OpenCover.Console.exe -target:"C:\Program Files\IIS Express\iisexpress.exe" \
-targetargs:"-config:\<Your Folder Path of applicationhost.config\>" \
-filter:+[\*]* \
-register:user \
"-searchdirs:\<Your Folder Path for Bin\>;\<Your Folder Path for Bin\>"

Example Code
```
OpenCover.Console.exe -target:"C:\Program Files\IIS Express\iisexpress.exe" -targetargs:"-config:C:\MyFolder\Demo\applicationhost_aspx.config" -filter:+[*]* -register:user "-searchdirs:C:\MyFolder\Demo\aspx\bin;C:\MyFolder\Demo\mvc\bin"
```
#### Note: 
Please do use opencover parameter as it is -register:user **NOT LIKE -register:anand**


#### ReportGenerator Open Cover

ReportGenerator.exe 
-reports:"\<Your Folder Path Of OpenCover Result.xml\>" \
-targetdir:"\<Folder Path To Output Reports\>" \
-sourcedirs:\<Your Folder Path for Bin\>;\<Your Folder Path for Bin\>" \
"-assemblyfilters:-\<Ignore Assemblies\>*"  \
"-classfilters:-\<Ignore Class filefilters\>*" \
"-filefilters:-\<Ignore file path\>*"

Example Code
```
ReportGenerator.exe -reports:"C:\OpenCover\opencover.4.7.922\results.xml" -targetdir:C:\MyFolder\Demo\zfunctionalCoverageReport "-sourcedirs:C:\MyFolder\Demo\aspx\bin;C:\MyFolder\Demo\mvc\bin" "-assemblyfilters:-Antlr3.Runtime*;-System.Web.UI.dll*" "-classfilters:-__ASP.FastObjectFactory*;-*.BundleConfig;-*.FilterConfig;-*.RouteConfig;-*.MvcApplication;-ASP._Page_Views__ViewStart_cshtml" "-filefilters:-C:\MyFolder\TFS\rmy\POC\OpenCover\aspx\*"
```
### IIS Express
```
32 Bit:	 C:\Program Files (x86)\IIS Express\iisexpress.exe
64 Bit:  C:\Program Files\IIS Express\iisexpress.exe
Configs: %userprofile%\documents\IISExpress\config
```
### IIS
```
32 Bit: C:\Windows\SysWOW64\inetsrv\w3wp.exe
64 Bit:	C:\windows\system32\inetsrv\w3wp.exe
Configs: C:\Windows\System32\inetsrv\config
```
### Step By Step Documentation Using IIS Express [Click Here](https://github.com/VAapps/OpenCoverDemo/blob/master/Docs/Step%20By%20Step.docx?raw=true)

### Convert OpenCover 32Bit Steps
In some case you need to deal with 32Bit compatible web apps then you need to convert open cover console exe to 32 bit \
Since Github open cover release does not have 32bit build setup \
 \
Run Developer Command Prompt for VS2019/2017. Execute Below statements \
CorFlags.exe <include path & opencover exe> /32BITREQ+ \
 \
Example Code
```
CorFlags.exe  C:\OpenCover\opencover.4.7.922\OpenCover.Console.exe  /32BITREQ+
```

